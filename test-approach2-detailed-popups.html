<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Approach 2: Zone-Specific Detailed Popups</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.12.0/mapbox-gl.js"></script>
    <style>
        body { margin: 0; padding: 0; font-family: Arial, sans-serif; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
        
        /* Custom Popup Styles */
        .mapboxgl-popup {
            max-width: 400px !important;
        }
        .mapboxgl-popup-content {
            padding: 0;
            border-radius: 12px;
            overflow: hidden;
        }
        
        /* Zone-specific popup headers */
        .popup-header {
            padding: 15px;
            color: white;
            font-weight: bold;
            font-size: 18px;
        }
        .popup-header-private {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }
        .popup-header-public {
            background: linear-gradient(135deg, #16a34a, #22c55e);
        }
        
        /* Popup content */
        .popup-content {
            padding: 20px;
        }
        .popup-section {
            margin-bottom: 15px;
        }
        .popup-section-title {
            font-weight: bold;
            color: #1e293b;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
        }
        .popup-section-title svg {
            width: 20px;
            height: 20px;
            margin-right: 8px;
        }
        .popup-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        .popup-list li {
            padding: 5px 0;
            color: #475569;
            display: flex;
            align-items: flex-start;
        }
        .popup-list li:before {
            content: "‚Ä¢";
            color: #94a3b8;
            margin-right: 8px;
            flex-shrink: 0;
        }
        
        /* Action buttons */
        .popup-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        .popup-button {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s;
            text-align: center;
            text-decoration: none;
        }
        .popup-button-primary {
            background: #3b82f6;
            color: white;
        }
        .popup-button-primary:hover {
            background: #2563eb;
        }
        .popup-button-secondary {
            background: #e2e8f0;
            color: #475569;
        }
        .popup-button-secondary:hover {
            background: #cbd5e1;
        }
        
        /* Warning badges */
        .warning-badge {
            background: #fee2e2;
            color: #dc2626;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
            display: inline-block;
            margin-bottom: 10px;
        }
        
        /* Legend */
        .legend {
            position: absolute;
            bottom: 40px;
            left: 20px;
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .legend-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #1e293b;
        }
        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }
        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
        }
        
        /* Mobile responsive */
        @media (max-width: 768px) {
            .mapboxgl-popup {
                max-width: 90vw !important;
            }
            .popup-actions {
                flex-direction: column;
            }
            .legend {
                bottom: 20px;
                left: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <div id="map"></div>
    
    <div class="legend">
        <div class="legend-title">Click zones for details</div>
        <div class="legend-item">
            <div class="legend-color" style="background: #fbbf24;"></div>
            <span>Private Property (Electric only)</span>
        </div>
        <div class="legend-item">
            <div class="legend-color" style="background: #22c55e;"></div>
            <span>Public Grilling Spots</span>
        </div>
    </div>

    <script>
    mapboxgl.accessToken = 'pk.eyJ1IjoiYm9iZXJzIiwiYSI6ImNtNDZ6Y3RuZzA5NmUyanB0aHlndWt0YnQifQ.0NqAw9QvIMAGpZL2PKtQJg';
    
    const map = new mapboxgl.Map({
        container: 'map',
        style: 'mapbox://styles/mapbox/light-v11',
        center: [13.405, 52.52],
        zoom: 11
    });
    
    // Sample data
    const privateZones = {
        type: 'FeatureCollection',
        features: [
            {
                type: 'Feature',
                geometry: {
                    type: 'Polygon',
                    coordinates: [[
                        [13.38, 52.50],
                        [13.40, 52.50],
                        [13.40, 52.52],
                        [13.38, 52.52],
                        [13.38, 52.50]
                    ]]
                },
                properties: {
                    type: 'private',
                    name: 'Mitte Residential District',
                    district: 'Mitte',
                    specificRules: 'Building management requires 48h notice',
                    fineAmount: '‚Ç¨50 - ‚Ç¨500'
                }
            },
            {
                type: 'Feature',
                geometry: {
                    type: 'Polygon',
                    coordinates: [[
                        [13.42, 52.51],
                        [13.44, 52.51],
                        [13.44, 52.53],
                        [13.42, 52.53],
                        [13.42, 52.51]
                    ]]
                },
                properties: {
                    type: 'private',
                    name: 'Prenzlauer Berg Residential',
                    district: 'Pankow',
                    specificRules: 'Courtyard use only, not on balconies',
                    fineAmount: '‚Ç¨100 - ‚Ç¨1,000'
                }
            }
        ]
    };
    
    const publicSpots = {
        type: 'FeatureCollection',
        features: [
            {
                type: 'Feature',
                geometry: {
                    type: 'Point',
                    coordinates: [13.412, 52.526]
                },
                properties: {
                    name: 'Mauerpark Grillplatz',
                    type: 'public',
                    capacity: '50 groups',
                    facilities: 'Water taps, waste bins, toilets nearby',
                    hours: '10:00 - 22:00',
                    restrictions: 'No glass bottles, loud music after 20:00'
                }
            },
            {
                type: 'Feature',
                geometry: {
                    type: 'Point',
                    coordinates: [13.373, 52.517]
                },
                properties: {
                    name: 'Tiergarten Grillwiese',
                    type: 'public',
                    capacity: '30 groups',
                    facilities: 'Waste bins, no water',
                    hours: 'Sunrise to sunset',
                    restrictions: 'Min 100m from monuments, no open fires'
                }
            }
        ]
    };
    
    map.on('load', () => {
        // Add sources and layers
        map.addSource('private-zones', {
            type: 'geojson',
            data: privateZones
        });
        
        map.addLayer({
            id: 'private-zones-fill',
            type: 'fill',
            source: 'private-zones',
            paint: {
                'fill-color': '#fbbf24',
                'fill-opacity': 0.3
            }
        });
        
        map.addLayer({
            id: 'private-zones-outline',
            type: 'line',
            source: 'private-zones',
            paint: {
                'line-color': '#f59e0b',
                'line-width': 2
            }
        });
        
        map.addSource('public-spots', {
            type: 'geojson',
            data: publicSpots
        });
        
        map.addLayer({
            id: 'public-spots',
            type: 'circle',
            source: 'public-spots',
            paint: {
                'circle-radius': 12,
                'circle-color': '#22c55e',
                'circle-stroke-color': '#16a34a',
                'circle-stroke-width': 3
            }
        });
        
        // Private zone popup
        map.on('click', 'private-zones-fill', (e) => {
            const props = e.features[0].properties;
            const popupContent = `
                <div class="popup-header popup-header-private">
                    üè† ${props.name}
                </div>
                <div class="popup-content">
                    <div class="warning-badge">‚ö†Ô∏è Restricted Zone</div>
                    
                    <div class="popup-section">
                        <div class="popup-section-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            Allowed Equipment
                        </div>
                        <ul class="popup-list">
                            <li>Electric grills only (max 2000W)</li>
                            <li>Contact grills permitted</li>
                            <li>No charcoal or gas equipment</li>
                        </ul>
                    </div>
                    
                    <div class="popup-section">
                        <div class="popup-section-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                            </svg>
                            Usage Limits
                        </div>
                        <ul class="popup-list">
                            <li>Maximum 2 times per month</li>
                            <li>Between 10:00 - 22:00 only</li>
                            <li>Check lease agreement first</li>
                        </ul>
                    </div>
                    
                    <div class="popup-section">
                        <div class="popup-section-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                            </svg>
                            District: ${props.district}
                        </div>
                        <ul class="popup-list">
                            <li>${props.specificRules}</li>
                            <li>Fines: ${props.fineAmount}</li>
                        </ul>
                    </div>
                    
                    <div class="popup-actions">
                        <button class="popup-button popup-button-secondary" onclick="alert('Downloading PDF guide...')">
                            üìÑ Download Rules
                        </button>
                        <button class="popup-button popup-button-primary" onclick="alert('Opening lease checker...')">
                            üîç Check My Lease
                        </button>
                    </div>
                </div>
            `;
            
            new mapboxgl.Popup({ maxWidth: '400px' })
                .setLngLat(e.lngLat)
                .setHTML(popupContent)
                .addTo(map);
        });
        
        // Public spot popup
        map.on('click', 'public-spots', (e) => {
            const props = e.features[0].properties;
            const coords = e.features[0].geometry.coordinates;
            const popupContent = `
                <div class="popup-header popup-header-public">
                    ‚úÖ ${props.name}
                </div>
                <div class="popup-content">
                    <div class="popup-section">
                        <div class="popup-section-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                            </svg>
                            Location Details
                        </div>
                        <ul class="popup-list">
                            <li>Capacity: ${props.capacity}</li>
                            <li>Hours: ${props.hours}</li>
                        </ul>
                    </div>
                    
                    <div class="popup-section">
                        <div class="popup-section-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                            </svg>
                            Facilities
                        </div>
                        <ul class="popup-list">
                            <li>${props.facilities}</li>
                        </ul>
                    </div>
                    
                    <div class="popup-section">
                        <div class="popup-section-title">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                            </svg>
                            Restrictions
                        </div>
                        <ul class="popup-list">
                            <li>${props.restrictions}</li>
                            <li>Clean up all waste</li>
                            <li>Respect other park users</li>
                        </ul>
                    </div>
                    
                    <div class="popup-actions">
                        <a href="https://maps.google.com/?q=${coords[1]},${coords[0]}" 
                           class="popup-button popup-button-secondary" 
                           target="_blank">
                            üìç Directions
                        </a>
                        <button class="popup-button popup-button-primary" 
                                onclick="alert('Checking current availability...')">
                            üë• Check Crowd
                        </button>
                    </div>
                </div>
            `;
            
            new mapboxgl.Popup({ maxWidth: '400px' })
                .setLngLat(coords)
                .setHTML(popupContent)
                .addTo(map);
        });
        
        // Cursor changes
        map.on('mouseenter', 'private-zones-fill', () => {
            map.getCanvas().style.cursor = 'pointer';
        });
        map.on('mouseleave', 'private-zones-fill', () => {
            map.getCanvas().style.cursor = '';
        });
        map.on('mouseenter', 'public-spots', () => {
            map.getCanvas().style.cursor = 'pointer';
        });
        map.on('mouseleave', 'public-spots', () => {
            map.getCanvas().style.cursor = '';
        });
    });
    </script>
</body>
</html>